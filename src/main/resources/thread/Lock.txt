lock汇编指令的的作用

汇编指令一般都分为两类：
1.本身具有原子性的，例如XADD,XCHG等
2.本身不具备原子性的，如CMPXCHG

使用lock指令修饰不具备原子行的指令时，可以使指令具有原子性，如lock CMPXCHG

lock指令通过两种方式来实现指令的原子性：
1.锁总线：lock指令执行的时候会向内存总线发送一个Lock信号，这个信号会导致其他的指令无法对内存进行存取，知道lock指
令执行完毕
2.锁缓存：cpu每次读取内存都是一个cache line（一般是64个字节）大小，如果是对一个cache line里面的内容进行存取的
话，可以只锁定这个cache line，但是当存取的范围超过一个cache line以后那就只能通过锁总线的方式了。

使用lock指令修饰后会提供内存屏障的作用
1.禁止指令重排序
2.使cache line失效
3.强制刷新缓存回主存
